<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />

  <title>数据类型转换 -- JavaScript 标准参考教程（alpha）</title>
  
  <!-- Included CSS Files (Uncompressed) -->
  <!--
  <link rel="stylesheet" href="stylesheets/foundation.css">
  -->
  
  <!-- Included CSS Files (Compressed) -->
  <link rel="stylesheet" href="/css/foundation.css">
  <link rel="stylesheet" href="/css/main.css">

  <!-- IE Fix for HTML5 Tags -->
  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <script src="/js/jquery.js"></script>
  <script src="/js/toc.js"></script>
  <script src="/js/main.js"></script>

</head>
<body>

<header class="top-bar" id="header">

<div class="fixed">

<nav class="top-bar">
<ul>
<!-- Title Area -->
	<li class="name has-dropdown">
	<h1><a href="/">JavaScript 标准参考教程（alpha） </a></h1>
		<ul class="dropdown">
			
			<li><a href="/#introduction">导论</a></li>
			
			<li><a href="/#grammar">语法</a></li>
			
			<li><a href="/#stdlib">标准库</a></li>
			
			<li><a href="/#oop">面向对象编程</a></li>
			
			<li><a href="/#advanced">语法专题</a></li>
			
			<li><a href="/#dom">DOM模型</a></li>
			
			<li><a href="/#bom">浏览器环境</a></li>
			
			<li><a href="/#htmlapi">Web API</a></li>
			
		</ul>
	</li>
</ul>

<section>


<ul class="left">
<li class="divider"></li>
<li class="has-dropdown"><a class="active" href="#"> 语法 </a><ul class="dropdown">







<li><a href="/grammar/array.html">数组</a></li>





















<li><a href="/grammar/basic.html">基本语法</a></li>



















<li class="active"><a href="#">数据类型转换</a></li>



































<li><a href="/grammar/error.html">错误处理机制</a></li>

























<li><a href="/grammar/function.html">函数</a></li>



























































<li><a href="/grammar/number.html">数值</a></li>





<li><a href="/grammar/object.html">对象</a></li>









<li><a href="/grammar/operator.html">运算符</a></li>























































<li><a href="/grammar/string.html">字符串</a></li>





<li><a href="/grammar/style.html">JavaScript 编程风格</a></li>















<li><a href="/grammar/types.html">数据类型</a></li>

























</ul></li>
<li class="divider"></li>
<li class="has-dropdown nav-3"><a href="#"> 数据类型转换</a><ul class="dropdown">
</ul></li>
</ul>


<ul class="right">
	<li class="divider"></li>
	<li>
		<a href="https://github.com/ruanyf/jstutorial" target="_blank">GitHub <i class="foundicon-edit"></i></a>
	</li>
	<li class="divider"></li>
	<li>
		<a href="#">TOP <i class="foundicon-up-arrow"></i></a>
	</li>
</ul>

</section>

</nav>  
</div>
</header>


<article class="bookPage">

  <div class="row">
    <div class="twelve columns">

<h1> 数据类型转换 </h1>

<aside class="right"><p>来自<a href="/">《JavaScript 标准参考教程（alpha）》</a>，by 阮一峰</p></aside>

<div id="toc" class="panel callout radius">目录</div>


<p>JavaScript 是一种动态类型语言，变量没有类型限制，可以随时赋予任意值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">y</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="s1">'a'</span><span class="p">;</span>
</code></pre></div></div>

<p>上面代码中，变量<code class="highlighter-rouge">x</code>到底是数值还是字符串，取决于另一个变量<code class="highlighter-rouge">y</code>的值。<code class="highlighter-rouge">y</code>为<code class="highlighter-rouge">true</code>时，<code class="highlighter-rouge">x</code>是一个数值；<code class="highlighter-rouge">y</code>为<code class="highlighter-rouge">false</code>时，<code class="highlighter-rouge">x</code>是一个字符串。这意味着，<code class="highlighter-rouge">x</code>的类型没法在编译阶段就知道，必须等到运行时才能知道。</p>

<p>虽然变量的数据类型是不确定的，但是各种运算符对数据类型是有要求的。如果运算符发现，运算子的类型与预期不符，就会自动转换类型。比如，减法运算符预期左右两侧的运算子应该是数值，如果不是，就会自动将它们转为数值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'4'</span> <span class="o">-</span> <span class="s1">'3'</span> <span class="c1">// 1</span>
</code></pre></div></div>

<p>上面代码中，虽然是两个字符串相减，但是依然会得到结果数值<code class="highlighter-rouge">1</code>，原因就在于 JavaScript 将运算子自动转为了数值。</p>

<p>本章讲解数据类型自动转换的规则。在此之前，先讲解如何手动强制转换数据类型。</p>

<h2 id="强制转换">强制转换</h2>

<p>强制转换主要指使用<code class="highlighter-rouge">Number</code>、<code class="highlighter-rouge">String</code>和<code class="highlighter-rouge">Boolean</code>三个函数，手动将各种类型的值，分布转换成数字、字符串或者布尔值。</p>

<h3 id="number">Number()</h3>

<p>使用<code class="highlighter-rouge">Number</code>函数，可以将任意类型的值转化成数值。</p>

<p>下面分成两种情况讨论，一种是参数是原始类型的值，另一种是参数是对象。</p>

<p><strong>（1）原始类型值</strong></p>

<p>原始类型值的转换规则如下。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 数值：转换后还是原来的值</span>
<span class="nb">Number</span><span class="p">(</span><span class="mi">324</span><span class="p">)</span> <span class="c1">// 324</span>

<span class="c1">// 字符串：如果可以被解析为数值，则转换为相应的数值</span>
<span class="nb">Number</span><span class="p">(</span><span class="s1">'324'</span><span class="p">)</span> <span class="c1">// 324</span>

<span class="c1">// 字符串：如果不可以被解析为数值，返回 NaN</span>
<span class="nb">Number</span><span class="p">(</span><span class="s1">'324abc'</span><span class="p">)</span> <span class="c1">// NaN</span>

<span class="c1">// 空字符串转为0</span>
<span class="nb">Number</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span> <span class="c1">// 0</span>

<span class="c1">// 布尔值：true 转成 1，false 转成 0</span>
<span class="nb">Number</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="c1">// 1</span>
<span class="nb">Number</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="c1">// 0</span>

<span class="c1">// undefined：转成 NaN</span>
<span class="nb">Number</span><span class="p">(</span><span class="kc">undefined</span><span class="p">)</span> <span class="c1">// NaN</span>

<span class="c1">// null：转成0</span>
<span class="nb">Number</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="c1">// 0</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">Number</code>函数将字符串转为数值，要比<code class="highlighter-rouge">parseInt</code>函数严格很多。基本上，只要有一个字符无法转成数值，整个字符串就会被转为<code class="highlighter-rouge">NaN</code>。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">parseInt</span><span class="p">(</span><span class="s1">'42 cats'</span><span class="p">)</span> <span class="c1">// 42</span>
<span class="nb">Number</span><span class="p">(</span><span class="s1">'42 cats'</span><span class="p">)</span> <span class="c1">// NaN</span>
</code></pre></div></div>

<p>上面代码中，<code class="highlighter-rouge">parseInt</code>逐个解析字符，而<code class="highlighter-rouge">Number</code>函数整体转换字符串的类型。</p>

<p>另外，<code class="highlighter-rouge">parseInt</code>和<code class="highlighter-rouge">Number</code>函数都会自动过滤一个字符串前导和后缀的空格。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">parseInt</span><span class="p">(</span><span class="s1">'</span><span class="err">\</span><span class="s1">t</span><span class="err">\</span><span class="s1">v</span><span class="err">\</span><span class="s1">r12.34</span><span class="err">\</span><span class="s1">n'</span><span class="p">)</span> <span class="c1">// 12</span>
<span class="nb">Number</span><span class="p">(</span><span class="s1">'</span><span class="err">\</span><span class="s1">t</span><span class="err">\</span><span class="s1">v</span><span class="err">\</span><span class="s1">r12.34</span><span class="err">\</span><span class="s1">n'</span><span class="p">)</span> <span class="c1">// 12.34</span>
</code></pre></div></div>

<p><strong>（2）对象</strong></p>

<p>简单的规则是，<code class="highlighter-rouge">Number</code>方法的参数是对象时，将返回<code class="highlighter-rouge">NaN</code>，除非是包含单个数值的数组。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Number</span><span class="p">({</span><span class="na">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span> <span class="c1">// NaN</span>
<span class="nb">Number</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="c1">// NaN</span>
<span class="nb">Number</span><span class="p">([</span><span class="mi">5</span><span class="p">])</span> <span class="c1">// 5</span>
</code></pre></div></div>

<p>之所以会这样，是因为<code class="highlighter-rouge">Number</code>背后的转换规则比较复杂。</p>

<p>第一步，调用对象自身的<code class="highlighter-rouge">valueOf</code>方法。如果返回原始类型的值，则直接对该值使用<code class="highlighter-rouge">Number</code>函数，不再进行后续步骤。</p>

<p>第二步，如果<code class="highlighter-rouge">valueOf</code>方法返回的还是对象，则改为调用对象自身的<code class="highlighter-rouge">toString</code>方法。如果<code class="highlighter-rouge">toString</code>方法返回原始类型的值，则对该值使用<code class="highlighter-rouge">Number</code>函数，不再进行后续步骤。</p>

<p>第三步，如果<code class="highlighter-rouge">toString</code>方法返回的是对象，就报错。</p>

<p>请看下面的例子。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">};</span>
<span class="nb">Number</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="c1">// NaN</span>

<span class="c1">// 等同于</span>
<span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">()</span> <span class="o">===</span> <span class="s1">'object'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Number</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nb">Number</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div></div>

<p>上面代码中，<code class="highlighter-rouge">Number</code>函数将<code class="highlighter-rouge">obj</code>对象转为数值。背后发生了一连串的操作，首先调用<code class="highlighter-rouge">obj.valueOf</code>方法, 结果返回对象本身；于是，继续调用<code class="highlighter-rouge">obj.toString</code>方法，这时返回字符串<code class="highlighter-rouge">[object Object]</code>，对这个字符串使用<code class="highlighter-rouge">Number</code>函数，得到<code class="highlighter-rouge">NaN</code>。</p>

<p>默认情况下，对象的<code class="highlighter-rouge">valueOf</code>方法返回对象本身，所以一般总是会调用<code class="highlighter-rouge">toString</code>方法，而<code class="highlighter-rouge">toString</code>方法返回对象的类型字符串（比如<code class="highlighter-rouge">[object Object]</code>）。所以，会有下面的结果。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Number</span><span class="p">({})</span> <span class="c1">// NaN</span>
</code></pre></div></div>

<p>如果<code class="highlighter-rouge">toString</code>方法返回的不是原始类型的值，结果就会报错。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">valueOf</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{};</span>
  <span class="p">},</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{};</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nb">Number</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
<span class="c1">// TypeError: Cannot convert object to primitive value</span>
</code></pre></div></div>

<p>上面代码的<code class="highlighter-rouge">valueOf</code>和<code class="highlighter-rouge">toString</code>方法，返回的都是对象，所以转成数值时会报错。</p>

<p>从上例还可以看到，<code class="highlighter-rouge">valueOf</code>和<code class="highlighter-rouge">toString</code>方法，都是可以自定义的。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Number</span><span class="p">({</span>
  <span class="na">valueOf</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// 2</span>

<span class="nb">Number</span><span class="p">({</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// 3</span>

<span class="nb">Number</span><span class="p">({</span>
  <span class="na">valueOf</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// 2</span>
</code></pre></div></div>

<p>上面代码对三个对象使用<code class="highlighter-rouge">Number</code>函数。第一个对象返回<code class="highlighter-rouge">valueOf</code>方法的值，第二个对象返回<code class="highlighter-rouge">toString</code>方法的值，第三个对象表示<code class="highlighter-rouge">valueOf</code>方法先于<code class="highlighter-rouge">toString</code>方法执行。</p>

<h3 id="string">String()</h3>

<p><code class="highlighter-rouge">String</code>函数可以将任意类型的值转化成字符串，转换规则如下。</p>

<p><strong>（1）原始类型值</strong></p>

<ul>
  <li><strong>数值</strong>：转为相应的字符串。</li>
  <li><strong>字符串</strong>：转换后还是原来的值。</li>
  <li><strong>布尔值</strong>：<code class="highlighter-rouge">true</code>转为字符串<code class="highlighter-rouge">"true"</code>，<code class="highlighter-rouge">false</code>转为字符串<code class="highlighter-rouge">"false"</code>。</li>
  <li><strong>undefined</strong>：转为字符串<code class="highlighter-rouge">"undefined"</code>。</li>
  <li><strong>null</strong>：转为字符串<code class="highlighter-rouge">"null"</code>。</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">String</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span> <span class="c1">// "123"</span>
<span class="nb">String</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">)</span> <span class="c1">// "abc"</span>
<span class="nb">String</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="c1">// "true"</span>
<span class="nb">String</span><span class="p">(</span><span class="kc">undefined</span><span class="p">)</span> <span class="c1">// "undefined"</span>
<span class="nb">String</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="c1">// "null"</span>
</code></pre></div></div>

<p><strong>（2）对象</strong></p>

<p><code class="highlighter-rouge">String</code>方法的参数如果是对象，返回一个类型字符串；如果是数组，返回该数组的字符串形式。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">String</span><span class="p">({</span><span class="na">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span> <span class="c1">// "[object Object]"</span>
<span class="nb">String</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="c1">// "1,2,3"</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">String</code>方法背后的转换规则，与<code class="highlighter-rouge">Number</code>方法基本相同，只是互换了<code class="highlighter-rouge">valueOf</code>方法和<code class="highlighter-rouge">toString</code>方法的执行顺序。</p>

<ol>
  <li>
    <p>先调用对象自身的<code class="highlighter-rouge">toString</code>方法。如果返回原始类型的值，则对该值使用<code class="highlighter-rouge">String</code>函数，不再进行以下步骤。</p>
  </li>
  <li>
    <p>如果<code class="highlighter-rouge">toString</code>方法返回的是对象，再调用原对象的<code class="highlighter-rouge">valueOf</code>方法。如果<code class="highlighter-rouge">valueOf</code>方法返回原始类型的值，则对该值使用<code class="highlighter-rouge">String</code>函数，不再进行以下步骤。</p>
  </li>
  <li>
    <p>如果<code class="highlighter-rouge">valueOf</code>方法返回的是对象，就报错。</p>
  </li>
</ol>

<p>下面是一个例子。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">String</span><span class="p">({</span><span class="na">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="c1">// "[object Object]"</span>

<span class="c1">// 等同于</span>
<span class="nb">String</span><span class="p">({</span><span class="na">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">}.</span><span class="nx">toString</span><span class="p">())</span>
<span class="c1">// "[object Object]"</span>
</code></pre></div></div>

<p>上面代码先调用对象的<code class="highlighter-rouge">toString</code>方法，发现返回的是字符串<code class="highlighter-rouge">[object Object]</code>，就不再调用<code class="highlighter-rouge">valueOf</code>方法了。</p>

<p>如果<code class="highlighter-rouge">toString</code>法和<code class="highlighter-rouge">valueOf</code>方法，返回的都是对象，就会报错。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">valueOf</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{};</span>
  <span class="p">},</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{};</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nb">String</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
<span class="c1">// TypeError: Cannot convert object to primitive value</span>
</code></pre></div></div>

<p>下面是通过自定义<code class="highlighter-rouge">toString</code>方法，改变返回值的例子。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">String</span><span class="p">({</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// "3"</span>

<span class="nb">String</span><span class="p">({</span>
  <span class="na">valueOf</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// "[object Object]"</span>

<span class="nb">String</span><span class="p">({</span>
  <span class="na">valueOf</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="c1">// "3"</span>
</code></pre></div></div>

<p>上面代码对三个对象使用<code class="highlighter-rouge">String</code>函数。第一个对象返回<code class="highlighter-rouge">toString</code>方法的值（数值3），第二个对象返回的还是<code class="highlighter-rouge">toString</code>方法的值（<code class="highlighter-rouge">[object Object]</code>），第三个对象表示<code class="highlighter-rouge">toString</code>方法先于<code class="highlighter-rouge">valueOf</code>方法执行。</p>

<h3 id="boolean">Boolean()</h3>

<p><code class="highlighter-rouge">Boolean</code>函数可以将任意类型的值转为布尔值。</p>

<p>它的转换规则相对简单：除了以下五个值的转换结果为<code class="highlighter-rouge">false</code>，其他的值全部为<code class="highlighter-rouge">true</code>。</p>

<ul>
  <li><code class="highlighter-rouge">undefined</code></li>
  <li><code class="highlighter-rouge">null</code></li>
  <li><code class="highlighter-rouge">-0</code>或<code class="highlighter-rouge">+0</code></li>
  <li><code class="highlighter-rouge">NaN</code></li>
  <li><code class="highlighter-rouge">''</code>（空字符串）</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Boolean</span><span class="p">(</span><span class="kc">undefined</span><span class="p">)</span> <span class="c1">// false</span>
<span class="nb">Boolean</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="c1">// false</span>
<span class="nb">Boolean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">// false</span>
<span class="nb">Boolean</span><span class="p">(</span><span class="kc">NaN</span><span class="p">)</span> <span class="c1">// false</span>
<span class="nb">Boolean</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span> <span class="c1">// false</span>
</code></pre></div></div>

<p>注意，所有对象（包括空对象）的转换结果都是<code class="highlighter-rouge">true</code>，甚至连<code class="highlighter-rouge">false</code>对应的布尔对象<code class="highlighter-rouge">new Boolean(false)</code>也是<code class="highlighter-rouge">true</code>（详见《原始类型值的包装对象》一章）。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Boolean</span><span class="p">({})</span> <span class="c1">// true</span>
<span class="nb">Boolean</span><span class="p">([])</span> <span class="c1">// true</span>
<span class="nb">Boolean</span><span class="p">(</span><span class="k">new</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">false</span><span class="p">))</span> <span class="c1">// true</span>
</code></pre></div></div>

<p>所有对象的布尔值都是<code class="highlighter-rouge">true</code>，这是因为 JavaScript 语言设计的时候，出于性能的考虑，如果对象需要计算才能得到布尔值，对于<code class="highlighter-rouge">obj1 &amp;&amp; obj2</code>这样的场景，可能会需要较多的计算。为了保证性能，就统一规定，对象的布尔值为<code class="highlighter-rouge">true</code>。</p>

<h2 id="自动转换">自动转换</h2>

<p>下面介绍自动转换，它是以强制转换为基础的。</p>

<p>遇到以下三种情况时，JavaScript 会自动转换数据类型，即转换是自动完成的，用户不可见。</p>

<p>第一种情况，不同类型的数据互相运算。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">123</span> <span class="o">+</span> <span class="s1">'abc'</span> <span class="c1">// "123abc"</span>
</code></pre></div></div>

<p>第二种情况，对非布尔值类型的数据求布尔值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="s1">'abc'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
<span class="p">}</span>  <span class="c1">// "hello"</span>
</code></pre></div></div>

<p>第三种情况，对非数值类型的值使用一元运算符（即<code class="highlighter-rouge">+</code>和<code class="highlighter-rouge">-</code>）。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">+</span> <span class="p">{</span><span class="na">foo</span><span class="p">:</span> <span class="s1">'bar'</span><span class="p">}</span> <span class="c1">// NaN</span>
<span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1">// NaN</span>
</code></pre></div></div>

<p>自动转换的规则是这样的：预期什么类型的值，就调用该类型的转换函数。比如，某个位置预期为字符串，就调用<code class="highlighter-rouge">String</code>函数进行转换。如果该位置即可以是字符串，也可能是数值，那么默认转为数值。</p>

<p>由于自动转换具有不确定性，而且不易除错，建议在预期为布尔值、数值、字符串的地方，全部使用<code class="highlighter-rouge">Boolean</code>、<code class="highlighter-rouge">Number</code>和<code class="highlighter-rouge">String</code>函数进行显式转换。</p>

<h3 id="自动转换为布尔值">自动转换为布尔值</h3>

<p>JavaScript 遇到预期为布尔值的地方（比如<code class="highlighter-rouge">if</code>语句的条件部分），就会将非布尔值的参数自动转换为布尔值。系统内部会自动调用<code class="highlighter-rouge">Boolean</code>函数。</p>

<p>因此除了以下五个值，其他都是自动转为<code class="highlighter-rouge">true</code>。</p>

<ul>
  <li><code class="highlighter-rouge">undefined</code></li>
  <li><code class="highlighter-rouge">null</code></li>
  <li><code class="highlighter-rouge">+0</code>或<code class="highlighter-rouge">-0</code></li>
  <li><code class="highlighter-rouge">NaN</code></li>
  <li><code class="highlighter-rouge">''</code>（空字符串）</li>
</ul>

<p>下面这个例子中，条件部分的每个值都相当于<code class="highlighter-rouge">false</code>，使用否定运算符后，就变成了<code class="highlighter-rouge">true</code>。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="kc">undefined</span>
  <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="kc">null</span>
  <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="mi">0</span>
  <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="kc">NaN</span>
  <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="s1">''</span>
<span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'true'</span><span class="p">);</span>
<span class="p">}</span> <span class="c1">// true</span>
</code></pre></div></div>

<p>下面两种写法，有时也用于将一个表达式转为布尔值。它们内部调用的也是<code class="highlighter-rouge">Boolean</code>函数。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 写法一</span>
<span class="nx">expression</span> <span class="p">?</span> <span class="kc">true</span> <span class="p">:</span> <span class="kc">false</span>

<span class="c1">// 写法二</span>
<span class="o">!!</span> <span class="nx">expression</span>
</code></pre></div></div>

<h3 id="自动转换为字符串">自动转换为字符串</h3>

<p>JavaScript 遇到预期为字符串的地方，就会将非字符串的值自动转为字符串。具体规则是，先将复合类型的值转为原始类型的值，再将原始类型的值转为字符串。</p>

<p>字符串的自动转换，主要发生在字符串的加法运算时。当一个值为字符串，另一个值为非字符串，则后者转为字符串。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'5'</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">// '51'</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="kc">true</span> <span class="c1">// "5true"</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="kc">false</span> <span class="c1">// "5false"</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="p">{}</span> <span class="c1">// "5[object Object]"</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="p">[]</span> <span class="c1">// "5"</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="kd">function</span> <span class="p">(){}</span> <span class="c1">// "5function (){}"</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="kc">undefined</span> <span class="c1">// "5undefined"</span>
<span class="s1">'5'</span> <span class="o">+</span> <span class="kc">null</span> <span class="c1">// "5null"</span>
</code></pre></div></div>

<p>这种自动转换很容易出错。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">width</span><span class="p">:</span> <span class="s1">'100'</span>
<span class="p">};</span>

<span class="nx">obj</span><span class="p">.</span><span class="nx">width</span> <span class="o">+</span> <span class="mi">20</span> <span class="c1">// "10020"</span>
</code></pre></div></div>

<p>上面代码中，开发者可能期望返回<code class="highlighter-rouge">120</code>，但是由于自动转换，实际上返回了一个字符<code class="highlighter-rouge">10020</code>。</p>

<h3 id="自动转换为数值">自动转换为数值</h3>

<p>JavaScript 遇到预期为数值的地方，就会将参数值自动转换为数值。系统内部会自动调用<code class="highlighter-rouge">Number</code>函数。</p>

<p>除了加法运算符（<code class="highlighter-rouge">+</code>）有可能把运算子转为字符串，其他运算符都会把运算子自动转成数值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'5'</span> <span class="o">-</span> <span class="s1">'2'</span> <span class="c1">// 3</span>
<span class="s1">'5'</span> <span class="o">*</span> <span class="s1">'2'</span> <span class="c1">// 10</span>
<span class="kc">true</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1">// 0</span>
<span class="kc">false</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1">// -1</span>
<span class="s1">'1'</span> <span class="o">-</span> <span class="mi">1</span>   <span class="c1">// 0</span>
<span class="s1">'5'</span> <span class="o">*</span> <span class="p">[]</span>    <span class="c1">// 0</span>
<span class="kc">false</span> <span class="o">/</span> <span class="s1">'5'</span> <span class="c1">// 0</span>
<span class="s1">'abc'</span> <span class="o">-</span> <span class="mi">1</span> <span class="err"> </span> <span class="c1">// NaN</span>
<span class="kc">null</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">// 1</span>
<span class="kc">undefined</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">// NaN</span>
</code></pre></div></div>

<p>上面代码中，运算符两侧的运算子，都被转成了数值。</p>

<blockquote>
  <p>注意：<code class="highlighter-rouge">null</code>转为数值时为<code class="highlighter-rouge">0</code>，而<code class="highlighter-rouge">undefined</code>转为数值时为<code class="highlighter-rouge">NaN</code>。</p>
</blockquote>

<p>一元运算符也会把运算子转成数值。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">+</span><span class="s1">'abc'</span> <span class="c1">// NaN</span>
<span class="o">-</span><span class="s1">'abc'</span> <span class="c1">// NaN</span>
<span class="o">+</span><span class="kc">true</span> <span class="c1">// 1</span>
<span class="o">-</span><span class="kc">false</span> <span class="c1">// 0</span>
</code></pre></div></div>

<h2 id="参考链接">参考链接</h2>

<ul>
  <li>Axel Rauschmayer, <a href="http://www.2ality.com/2012/01/object-plus-object.html">What is {} + {} in JavaScript?</a></li>
  <li>Axel Rauschmayer, <a href="http://www.2ality.com/2013/04/quirk-implicit-conversion.html">JavaScript quirk 1: implicit conversion of values</a></li>
  <li>Benjie Gillam, <a href="http://www.benjiegillam.com/2013/06/quantum-javascript/">Quantum JavaScript?</a></li>
</ul>


</article>

<div class="row">
<div class="twelve columns">

<h2>留言</h2>

<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jstutorial'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</section>

</div>
</div>

<footer>
<div class="row">
<div class="twelve columns">
	<p><a href="/introduction/license.html">版权声明</a> | last modified on 2013-12-05 </p>
</div>
</div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43771063-1', 'ruanyifeng.com');
  ga('send', 'pageview');
</script>
</body>
</html>


