<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />

  <title>移动设备API -- JavaScript 标准参考教程（alpha）</title>
  
  <!-- Included CSS Files (Uncompressed) -->
  <!--
  <link rel="stylesheet" href="stylesheets/foundation.css">
  -->
  
  <!-- Included CSS Files (Compressed) -->
  <link rel="stylesheet" href="/css/foundation.css">
  <link rel="stylesheet" href="/css/main.css">

  <!-- IE Fix for HTML5 Tags -->
  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <script src="/js/jquery.js"></script>
  <script src="/js/toc.js"></script>
  <script src="/js/main.js"></script>

</head>
<body>

<header class="top-bar" id="header">

<div class="fixed">

<nav class="top-bar">
<ul>
<!-- Title Area -->
	<li class="name has-dropdown">
	<h1><a href="/">JavaScript 标准参考教程（alpha） </a></h1>
		<ul class="dropdown">
			
			<li><a href="/#introduction">导论</a></li>
			
			<li><a href="/#grammar">语法</a></li>
			
			<li><a href="/#stdlib">标准库</a></li>
			
			<li><a href="/#oop">面向对象编程</a></li>
			
			<li><a href="/#advanced">语法专题</a></li>
			
			<li><a href="/#dom">DOM模型</a></li>
			
			<li><a href="/#bom">浏览器环境</a></li>
			
			<li><a href="/#htmlapi">Web API</a></li>
			
		</ul>
	</li>
</ul>

<section>


<ul class="left">
<li class="divider"></li>
<li class="has-dropdown"><a class="active" href="#"> 浏览器环境 </a><ul class="dropdown">



<li><a href="/bom/ajax.html">AJAX</a></li>











































<li><a href="/bom/cookie.html">Cookie</a></li>





<li><a href="/bom/cors.html">CORS通信</a></li>





























<li><a href="/bom/engine.html">浏览器环境概述</a></li>

































<li><a href="/bom/history.html">history对象</a></li>













<li><a href="/bom/indexeddb.html">IndexedDB：浏览器端数据库</a></li>























<li class="active"><a href="#">移动设备API</a></li>

















<li><a href="/bom/notification.html">Web Notifications API</a></li>





























<li><a href="/bom/performance.html">Performance API</a></li>



























<li><a href="/bom/same-origin.html">同源政策</a></li>











































<li><a href="/htmlapi/webrtc.html">WebRTC</a></li>





<li><a href="/htmlapi/websocket.html">WebSocket</a></li>







<li><a href="/bom/webstorage.html">Web Storage：浏览器端数据储存机制</a></li>







<li><a href="/bom/window.html">window对象</a></li>





</ul></li>
<li class="divider"></li>
<li class="has-dropdown nav-3"><a href="#"> 移动设备API</a><ul class="dropdown">
</ul></li>
</ul>


<ul class="right">
	<li class="divider"></li>
	<li>
		<a href="https://github.com/ruanyf/jstutorial" target="_blank">GitHub <i class="foundicon-edit"></i></a>
	</li>
	<li class="divider"></li>
	<li>
		<a href="#">TOP <i class="foundicon-up-arrow"></i></a>
	</li>
</ul>

</section>

</nav>  
</div>
</header>


<article class="bookPage">

  <div class="row">
    <div class="twelve columns">

<h1> 移动设备API </h1>

<aside class="right"><p>来自<a href="/">《JavaScript 标准参考教程（alpha）》</a>，by 阮一峰</p></aside>

<div id="toc" class="panel callout radius">目录</div>


<p>为了更好地为移动设备服务，HTML 5推出了一系列针对移动设备的API。</p>

<h2 id="permission-api">Permission API</h2>

<p>很多操作需要用户许可，比如脚本想要知道用户的位置，或者操作用户机器上的摄像头。</p>

<p>Permissions API就是用来查询某个接口的许可情况。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 查询地理位置接口的许可情况</span>
<span class="nb">navigator</span><span class="p">.</span><span class="nx">permissions</span><span class="p">.</span><span class="nx">query</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'geolocation'</span> <span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// 状态为 prompt，表示查询地理位置时，</span>
  <span class="c1">// 用户会得到提示，是否许可本次查询</span>
  <span class="cm">/* result.status = "prompt" */</span>

  <span class="c1">// 状态为 granted，表示用户已经给予了许可</span>
  <span class="cm">/* result.status = "granted" */</span>
<span class="p">});</span>
</code></pre></div></div>

<p>有了这个API，就可以自动查询用户的态度。当用户已经明确拒绝的时候，就可以不必再次询问用户许可了。</p>

<h2 id="viewport">Viewport</h2>

<p>Viewport指的是网页的显示区域，也就是不借助滚动条的情况下，用户可以看到的部分网页大小，中文译为“视口”。正常情况下，viewport和浏览器的显示窗口是一样大小的。但是，在移动设备上，两者可能不是一样大小。</p>

<p>比如，手机浏览器的窗口宽度可能是640像素，这时viewport宽度就是640像素，但是网页宽度有950像素，正常情况下，浏览器会提供横向滚动条，让用户查看窗口容纳不下的310个像素。另一种方法则是，将viewport设成950像素，也就是说，浏览器的显示宽度还是640像素，但是网页的显示区域达到950像素，整个网页缩小了，在浏览器中可以看清楚全貌。这样一来，手机浏览器就可以看到网页在桌面浏览器上的显示效果。</p>

<p>viewport缩放规则，需要在HTML网页的head部分指定。</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0, user-scalable=no"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</code></pre></div></div>

<p>上面代码指定，viewport的缩放规则是，缩放到当前设备的屏幕宽度（device-width），初始缩放比例（initial-scale）为1倍，禁止用户缩放（user-scalable）。</p>

<p>viewport 全部属性如下。</p>

<ul>
  <li>width: viewport宽度</li>
  <li>height: viewport高度</li>
  <li>initial-scale: 初始缩放比例</li>
  <li>maximum-scale: 最大缩放比例</li>
  <li>minimum-scale: 最小缩放比例</li>
  <li>user-scalable: 是否允许用户缩放</li>
</ul>

<p>其他的例子如下。</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;meta</span> <span class="na">name =</span><span class="err"> </span><span class="s">"viewport"</span> <span class="na">content =</span><span class="err"> </span><span class="s">"width = 320,
  initial-scale = 2.3, user-scalable = no"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<h2 id="geolocation-api">Geolocation API</h2>

<p>Geolocation接口用于获取用户的地理位置。它使用的方法基于GPS或者其他机制（比如IP地址、Wifi热点、手机基站等）。</p>

<p>下面的方法，可以检查浏览器是否支持这个接口。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">if</span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">)</span> <span class="p">{</span> 
   <span class="c1">// 支持</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="c1">// 不支持</span>
<span class="p">}</span></code></pre></figure>

<p>这个API的支持情况非常好，所有浏览器都支持（包括IE 9+），所以上面的代码不是很必要。</p>

<h3 id="getcurrentposition方法">getCurrentPosition方法</h3>

<p>getCurrentPosition方法，用来获取用户的地理位置。使用它需要得到用户的授权，浏览器会跳出一个对话框，询问用户是否许可当前页面获取他的地理位置。必须考虑两种情况的回调函数：一种是同意授权，另一种是拒绝授权。如果用户拒绝授权，会抛出一个错误。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="nx">geoSuccess</span><span class="p">,</span><span class="nx">geoError</span><span class="p">);</span></code></pre></figure>

<p>上面代码指定了处理当前地理位置的两个回调函数。</p>

<p><strong>（1）同意授权</strong></p>

<p>如果用户同意授权，就会调用geoSuccess。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">geoSuccess</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span> <span class="o">+</span> <span class="s1">', '</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>geoSuccess的参数是一个event对象。event有两个属性：timestamp和coords。timestamp属性是一个时间戳，返回获得位置信息的具体时间。coords属性指向一个对象，包含了用户的位置信息，主要是以下几个值：</p>

<ul>
  <li><strong>coords.latitude</strong>：纬度</li>
  <li><strong>coords.longitude</strong>：经度</li>
  <li><strong>coords.accuracy</strong>：精度</li>
  <li><strong>coords.altitude</strong>：海拔</li>
  <li><strong>coords.altitudeAccuracy</strong>：海拔精度（单位：米）</li>
  <li><strong>coords.heading</strong>：以360度表示的方向</li>
  <li><strong>coords.speed</strong>：每秒的速度（单位：米）</li>
</ul>

<p>大多数桌面浏览器不提供上面列表的后四个值。</p>

<p><strong>（2）拒绝授权</strong></p>

<p>如果用户拒绝授权，就会调用getCurrentPosition方法指定的第二个回调函数geoError。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">geoError</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span> 
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Error code "</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">code</span> <span class="o">+</span> <span class="s2">". "</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>geoError的参数也是一个event对象。event.code属性表示错误类型，有四个值：</p>

<ul>
  <li><strong>0</strong>：未知错误，浏览器没有提示出错的原因，相当于常量event.UNKNOWN_ERROR。</li>
  <li><strong>1</strong>：用户拒绝授权，相当于常量event.PERMISSION_DENIED。</li>
  <li><strong>2</strong>：没有得到位置，GPS或其他定位机制无法定位，相当于常量event.POSITION_UNAVAILABLE。</li>
  <li><strong>3</strong>：超时，GPS没有在指定时间内返回结果，相当于常量event.TIMEOUT。</li>
</ul>

<p><strong>(3)设置定位行为</strong></p>

<p>getCurrentPosition方法还可以接受一个对象作为第三个参数，用来设置定位行为。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">enableHighAccuracy</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">timeout</span> <span class="p">:</span> <span class="kc">Infinity</span><span class="p">,</span>
            <span class="na">maximumAge</span> <span class="p">:</span> <span class="mi">0</span>
        <span class="p">};</span>

<span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="nx">geoSuccess</span><span class="p">,</span> <span class="nx">geoError</span><span class="p">,</span> <span class="nx">option</span><span class="p">);</span></code></pre></figure>

<p>这个参数对象有三个成员：</p>

<ul>
  <li>
    <p><strong>enableHighAccuracy</strong>：如果设为true，就要求客户端提供更精确的位置信息，这会导致更长的定位时间和更大的耗电，默认设为false。</p>
  </li>
  <li>
    <p><strong>Timeout</strong>：等待客户端做出回应的最大毫秒数，默认值为Infinity（无限）。</p>
  </li>
  <li>
    <p><strong>maximumAge</strong>：客户端可以使用缓存数据的最大毫秒数。如果设为0，客户端不读取缓存；如果设为infinity，客户端只读取缓存。</p>
  </li>
</ul>

<h3 id="watchposition方法和clearwatch方法">watchPosition方法和clearWatch方法</h3>

<p>watchPosition方法可以用来监听用户位置的持续改变，使用方法与getCurrentPosition方法一样。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">watchID</span> <span class="o">=</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">watchPosition</span><span class="p">(</span><span class="nx">geoSuccess</span><span class="p">,</span><span class="nx">geoError</span><span class="p">,</span> <span class="nx">option</span><span class="p">);</span></code></pre></figure>

<p>一旦用户位置发生变化，就会调用回调函数geoSuccess。这个回调函数的事件对象，也包含timestamp和coords属性。</p>

<p>watchPosition和getCurrentPosition方法的不同之处在于，前者返回一个表示符，后者什么都不返回。watchPosition方法返回的标识符，用于供clearWatch方法取消监听。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">clearWatch</span><span class="p">(</span><span class="nx">watchID</span><span class="p">);</span></code></pre></figure>

<h2 id="vibration-api">Vibration API</h2>

<p>Vibration接口用于在浏览器中发出命令，使得设备振动。显然，这个API主要针对手机，适用场合是向用户发出提示或警告，游戏中尤其会大量使用。由于振动操作很耗电，在低电量时最好取消该操作。</p>

<p>使用下面的代码检查该接口是否可用。目前，只有Chrome和Firefox的Android平台最新版本支持它。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span> <span class="o">=</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span>
  <span class="o">||</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">webkitVibrate</span>
  <span class="o">||</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">mozVibrate</span>
  <span class="o">||</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">msVibrate</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// 支持</span>
<span class="p">}</span>
</code></pre></div></div>

<p>vibrate方法可以使得设备振动，它的参数就是振动持续的毫秒数。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</code></pre></div></div>

<p>上面的代码使得设备振动1秒钟。</p>

<p>vibrate方法还可以接受一个数组作为参数，表示振动的模式。偶数位置的数组成员表示振动的毫秒数，奇数位置的数组成员表示等待的毫秒数。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">]);</span>
</code></pre></div></div>

<p>上面代码表示，设备先振动500毫秒，然后等待300毫秒，再接着振动100毫秒。</p>

<p>vibrate是一个非阻塞式的操作，即手机振动的同时，JavaScript代码继续向下运行。要停止振动，只有将0毫秒或者一个空数组传入vibrate方法。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">([]);</span>
</code></pre></div></div>

<p>如果要让振动一直持续，可以使用setInterval不断调用vibrate。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">vibrateInterval</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">startVibrate</span><span class="p">(</span><span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
	<span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">(</span><span class="nx">duration</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">stopVibrate</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">vibrateInterval</span><span class="p">)</span> <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">vibrateInterval</span><span class="p">);</span>
	<span class="nb">navigator</span><span class="p">.</span><span class="nx">vibrate</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">startPeristentVibrate</span><span class="p">(</span><span class="nx">duration</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">vibrateInterval</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">startVibrate</span><span class="p">(</span><span class="nx">duration</span><span class="p">);</span>
	<span class="p">},</span> <span class="nx">interval</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="luminosity-api">Luminosity API</h2>

<p>Luminosity API用于屏幕亮度调节，当移动设备的亮度传感器感知外部亮度发生显著变化时，会触发devicelight事件。目前，只有Firefox部署了这个API。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'devicelight'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">'lux'</span><span class="p">);</span>
<span class="p">});</span></code></pre></figure>

<p>上面代码表示，devicelight事件的回调函数，接受一个事件对象作为参数。该对象的value属性就是亮度的流明值。</p>

<p>这个API的一种应用是，如果亮度变强，网页可以显示黑底白字，如果亮度变弱，网页可以显示白底黑字。</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'devicelight'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">lux</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">lux</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'dim'</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">lux</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="o">&amp;&amp;</span> <span class="nx">lux</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">lux</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">)</span>  <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'bright'</span><span class="p">;</span>
  <span class="p">}</span> 
<span class="p">});</span></code></pre></figure>

<p>CSS下一个版本的Media Query可以单独设置亮度，一旦浏览器支持，就可以用来取代Luminosity API。</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">@media</span> <span class="p">(</span><span class="n">light-level</span><span class="p">:</span> <span class="n">dim</span><span class="p">)</span> <span class="p">{</span>
  <span class="c">/* 暗光环境 */</span>
<span class="p">}</span>

<span class="k">@media</span> <span class="p">(</span><span class="n">light-level</span><span class="p">:</span> <span class="nb">normal</span><span class="p">)</span> <span class="p">{</span>
  <span class="c">/* 正常光环境 */</span>
<span class="p">}</span>

<span class="k">@media</span> <span class="p">(</span><span class="n">light-level</span><span class="p">:</span> <span class="n">washed</span><span class="p">)</span> <span class="p">{</span>
  <span class="c">/* 明亮环境 */</span>
<span class="p">}</span>

</code></pre></div></div>

<h2 id="orientation-api">Orientation API</h2>

<p>Orientation API用于检测手机的摆放方向（竖放或横放）。</p>

<p>使用下面的代码检测浏览器是否支持该API。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DeviceOrientationEvent</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// 支持</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// 不支持</span>
<span class="p">}</span>

</code></pre></div></div>

<p>一旦设备的方向发生变化，会触发deviceorientation事件，可以对该事件指定回调函数。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"deviceorientation"</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>

</code></pre></div></div>

<p>回调函数接受一个event对象作为参数。</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">function</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">alpha</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">beta</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">gamma</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>

<p>上面代码中，event事件对象有alpha、beta和gamma三个属性，它们分别对应手机摆放的三维倾角变化。要理解它们，就要理解手机的方向模型。当手机水平摆放时，使用三个轴标示它的空间位置：x轴代表横轴、y轴代表竖轴、z轴代表垂直轴。event对象的三个属性就对应这三根轴的旋转角度。</p>

<ul>
  <li>alpha：表示围绕z轴的旋转，从0到360度。当设备水平摆放时，顶部指向地球的北极，alpha此时为0。</li>
  <li>beta：表示围绕x轴的旋转，从-180度到180度。当设备水平摆放时，beta此时为0。</li>
  <li>gramma：表示围绕y轴的选择，从-90到90度。当设备水平摆放时，gramma此时为0。</li>
</ul>

<h2 id="参考链接">参考链接</h2>

<ul>
  <li>Ryan Stewart, <a href="http://www.adobe.com/devnet/html5/articles/using-geolocation-api.html">Using the Geolocation API</a></li>
  <li>Rathnakanya K. Srinivasan, <a href="http://www.sitepoint.com/html5-geolocation/">HTML5 Geolocation</a></li>
  <li>Craig Buckler, <a href="http://www.sitepoint.com/use-html5-vibration-api/">How to Use the HTML5 Vibration API</a></li>
  <li>Tomomi Imura, <a href="http://girliemac.com/blog/2014/01/12/luminosity/">Responsive UI with Luminosity Level</a></li>
  <li>Aurelio De Rosa, <a href="http://code.tutsplus.com/tutorials/an-introduction-to-the-geolocation-api--cms-20071">An Introduction to the Geolocation API</a></li>
  <li>David Walsh, <a href="http://davidwalsh.name/vibration-api">Vibration API</a></li>
  <li>Ahmet Mermerkaya, <a href="http://www.sitepoint.com/using-device-orientation-html5/">Using Device Orientation in HTML5</a></li>
</ul>


</article>

<div class="row">
<div class="twelve columns">

<h2>留言</h2>

<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jstutorial'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</section>

</div>
</div>

<footer>
<div class="row">
<div class="twelve columns">
	<p><a href="/introduction/license.html">版权声明</a> | last modified on 2013-12-20 </p>
</div>
</div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43771063-1', 'ruanyifeng.com');
  ga('send', 'pageview');
</script>
</body>
</html>


